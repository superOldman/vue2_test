{"version":3,"sources":["webpack:///./src/pages/directiveTest.vue?716f","webpack:///./src/pages/directiveTest.vue?3e05","webpack:///./src/components/textOverflow.vue?ff5e","webpack:///src/components/textOverflow.vue","webpack:///./src/components/textOverflow.vue?ac91","webpack:///./src/components/textOverflow.vue","webpack:///src/pages/directiveTest.vue","webpack:///./src/pages/directiveTest.vue?d123","webpack:///./src/pages/directiveTest.vue","webpack:///./src/components/textOverflow.vue?cdad"],"names":["render","_vm","this","_h","$createElement","_c","_self","on","$event","text","_v","aaa","aaa2","good","more1","staticClass","attrs","_s","staticRenderFns","ref","mouseEnter","mouseLeave","class","lines","style","width","_t","tooltipContent","debounce","fn","time","e","clearTimeout","timeout","setTimeout","call","name","props","type","String","default","data","tooltip","methods","activateTooltip","range","setStart","dom","setEnd","childNodes","length","console","log","domHeight","rangeHeight","domWidth","rangeWidth","window","referenceElm","$refs","popper","display","doDestroy","setExpectedState","show","handleClosePopper","component","components","a","created","watch","directives","focus2","inserted","el","focus","demo","bind","innerHtml","mounted","computedWidth"],"mappings":"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","file":"js/chunk-4b3617f2.eab63655.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./directiveTest.vue?vue&type=style&index=0&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('el-button',{on:{\"click\":function($event){_vm.text='dsafa'}}},[_vm._v(\"少字\")]),_c('el-button',{on:{\"click\":function($event){_vm.text=_vm.aaa}}},[_vm._v(\"多字\")]),_c('el-button',{on:{\"click\":function($event){_vm.text=_vm.aaa2}}},[_vm._v(\"多字少于三行\")]),_c('el-button',{on:{\"click\":function($event){_vm.text=_vm.good}}},[_vm._v(\"==\")]),_c('el-button',{on:{\"click\":function($event){_vm.text=_vm.more1}}},[_vm._v(\"多1\")]),_c('div',{staticClass:\"textBox\",attrs:{\"id\":\"box\"}},[_c('text-overflow',{attrs:{\"lines\":\"1\"}},[_vm._v(_vm._s(_vm.text))])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"textBox\",on:{\"mouseenter\":_vm.mouseEnter,\"mouseleave\":_vm.mouseLeave}},[_c('div',{ref:\"textBoxWrap\",staticClass:\"textOverflow\",class:{'multiLine':_vm.lines!=='1'},style:({width: _vm.width,'-webkit-line-clamp': _vm.lines!=='1'?_vm.lines: null})},[_vm._t(\"default\")],2),_c('el-tooltip',{ref:\"tooltip\",staticClass:\"item\",attrs:{\"effect\":\"dark\",\"content\":_vm.tooltipContent,\"placement\":\"top\"}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div ref=\"textBox\" @mouseenter=\"mouseEnter\" @mouseleave=\"mouseLeave\">\r\n    <div class=\"textOverflow\" :class=\"{'multiLine':lines!=='1'}\" ref=\"textBoxWrap\" :style=\"{width,'-webkit-line-clamp': lines!=='1'?lines: null}\">\r\n      <slot />\r\n    </div>\r\n    <el-tooltip class=\"item\" ref=\"tooltip\" effect=\"dark\" :content=\"tooltipContent\" placement=\"top\" />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nfunction debounce(fn, time) {\r\n  let timeout = null;\r\n  return function (e) {\r\n    clearTimeout(timeout);\r\n    timeout = setTimeout(() => {\r\n      fn.call(this, e);\r\n    }, time);\r\n  };\r\n}\r\nexport default {\r\n  name: 'textOverflow',\r\n  props: {\r\n    lines: {\r\n      type: String,\r\n      default: '1'\r\n    },\r\n    width: {\r\n      type: String\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      tooltip: true,\r\n      tooltipContent: ''\r\n    };\r\n  },\r\n  methods: {\r\n    activateTooltip: debounce(tooltip => tooltip.handleShowPopper(), 50),\r\n    mouseEnter() {\r\n      const dom = this.$refs.textBoxWrap;\r\n      // 获取渲染元素\r\n      const range = document.createRange();\r\n      range.setStart(dom, 0);\r\n      range.setEnd(dom, dom.childNodes.length);\r\n\r\n      const rangeRect = range.getBoundingClientRect();\r\n      const domRect = dom.getBoundingClientRect();\r\n      const rangeWidth = rangeRect.width;\r\n      const domWidth = domRect.width;\r\n      const rangeHeight = rangeRect.height;\r\n      const domHeight = domRect.height;\r\n\r\n      console.log('真实height', domHeight);\r\n      console.log('渲染height', rangeHeight);\r\n      console.log('真实width', domWidth);\r\n      console.log('渲染width', rangeWidth);\r\n\r\n      let show = () => {\r\n        this.tooltip = true;\r\n        // 添加tootip内容 设置tootip渲染\r\n        this.tooltipContent = dom.innerText || dom.textContent;\r\n        console.log(this.tooltipContent);\r\n        window.dom = dom;\r\n        const tooltip = this.$refs.tooltip;\r\n        tooltip.referenceElm = dom;\r\n        tooltip.$refs.popper && (tooltip.$refs.popper.style.display = 'none');\r\n        tooltip.doDestroy();\r\n        tooltip.setExpectedState(true);\r\n        this.activateTooltip(tooltip);\r\n      };\r\n\r\n      // if (rangeWidth + 10 < domWidth) {\r\n      if (rangeHeight <= domHeight && rangeWidth <= domWidth) {\r\n        this.tooltip = false;\r\n      }\r\n      else if (this.lines !== '1' && rangeHeight <= domHeight) {\r\n        this.tooltip = false;\r\n      } else {\r\n        show();\r\n      }\r\n    },\r\n    mouseLeave() {\r\n      const tooltip = this.$refs.tooltip;\r\n      if (tooltip) {\r\n        tooltip.setExpectedState(false);\r\n        tooltip.handleClosePopper();\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.textOverflow {\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  white-space: nowrap;\r\n}\r\n.multiLine {\r\n  display: -webkit-box;\r\n  -webkit-box-orient: vertical;\r\n  white-space: unset;\r\n}\r\n.textOverflow--3 {\r\n  -webkit-line-clamp: 3;\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./textOverflow.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./textOverflow.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./textOverflow.vue?vue&type=template&id=6f82dea5&scoped=true&\"\nimport script from \"./textOverflow.vue?vue&type=script&lang=js&\"\nexport * from \"./textOverflow.vue?vue&type=script&lang=js&\"\nimport style0 from \"./textOverflow.vue?vue&type=style&index=0&id=6f82dea5&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6f82dea5\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div>\r\n    <!-- <input type=\"text\" v-model=\"a\" />\r\n    <br />\r\n    <input type=\"text\" v-model=\"a\" v-focus2 />\r\n    <br />\r\n    <input type=\"text\" v-model=\"a\" v-focus />\r\n\r\n    <div class=\"textBox\" v-textOverflow>\r\n      是大法师打\r\n      是大法师打发\r\n      是大法师打发\r\n      是大法师打发\r\n      是大法师打发\r\n      是大法师打发\r\n    </div>\r\n    <div class=\"textBox\" v-textOverflow>\r\n      是大法师打\r\n    </div> -->\r\n\r\n    <!-- <text-overflow width=\"1000px\">\r\n      <el-input v-model=\"text\" autocomplete=\"off\" :title=\"text\" />\r\n    </text-overflow> -->\r\n\r\n    <el-button @click=\"text='dsafa'\">少字</el-button>\r\n    <el-button @click=\"text=aaa\">多字</el-button>\r\n    <el-button @click=\"text=aaa2\">多字少于三行</el-button>\r\n    <el-button @click=\"text=good\">==</el-button>\r\n    <el-button @click=\"text=more1\">多1</el-button>\r\n\r\n    <div class=\"textBox\" id=\"box\">\r\n      <text-overflow  lines=\"1\">{{text}}</text-overflow>\r\n    </div>\r\n    <!-- <el-tooltip :disabled='true' content=\"3\" placement=\"top\" effect=\"light\">\r\n      <span ref=\"span\" class=\"textOverflow\">{{3}}</span>\r\n    </el-tooltip> -->\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport textOverflow from '@/components/textOverflow.vue';\r\nexport default {\r\n  components: { textOverflow },\r\n  data() {\r\n    return {\r\n      a: 0,\r\n      text: 'dsafa',\r\n      aaa: `毒贩夫妇付付付付付付付付付付付付付付付付付付付付付付大法师打发是大法师打发是大法师打发是大法师打发是大法师\r\n      毒贩夫妇付付付付付付付付付付付付付付付付付付付付付付大法师打发是大法师打发是大法师打发是大法师打发是大法师\r\n      毒贩夫妇付付付付付付付付付付付付付付付付付付付付付付大法师打发是大法师打发是大法师打发是大法师打发是大法师\r\n      毒贩夫妇付付付付付付付付付付付付付付付付付付付付付付大法师打发是大法师打发是大法师打发是大法师打发是大法师\r\n      毒贩夫妇付付付付付付付付付付付付付付付付付付付付付付大法师打发是大法师打发是大法师打发是大法师打发是大法师\r\n      毒贩夫妇付付付付付付付付付付付付付付付付付付付付付付大法师打发是大法师打发是大法师打发是大法师打发是大法师\r\n      毒贩夫妇付付付付付付付付付付付付付付付付付付付付付付大法师打发是大法师打发是大法师打发是大法师打发是大法师\r\n      毒贩夫妇付付付付付付付付付付付付付付付付付付付付付付大法师打发是大法师打发是大法师打发是大法师打发是大法师\r\n      毒贩夫妇付付付付付付付付付付付付付付付付付付付付付付大法师打发是大法师打发是大法师打发是大法师打发是大法师\r\n      毒贩夫妇付付付付付付付付付付付付付付付付付付付付付付大法师打发是大法师打发是大法师打发是大法师打发是大法师\r\n      `,\r\n      aaa2: '毒贩夫妇付付付付付付付付付付付付付付付付付付付付付付',\r\n      good: '毒贩夫妇付付付付付付付付付付付付付付付付付付付付付1付1',\r\n      more1: '毒贩夫妇付付付付付付付付付付付付付付付付付付付付付1付11'\r\n    };\r\n  },\r\n\r\n  created() { },\r\n  watch: {},\r\n  // 局部自定义指令指令\r\n  directives: {\r\n    focus2: {\r\n      // 指令的定义\r\n      inserted: function (el) {\r\n        el.focus();\r\n      }\r\n    },\r\n    demo: {\r\n      bind: function (el, binding, vnode) {\r\n        el.innerHtml = `name: ${binding.name}\r\n        ${vnode}\r\n        `;\r\n      }\r\n    }\r\n\r\n  },\r\n  mounted() {\r\n    this.computedWidth();\r\n  },\r\n  methods: {\r\n    //     // 判断是否text-overflow, 如果是就显示tooltip\r\n    // const cellChild = event.target.querySelector('.cell');\r\n    // if (!(hasClass(cellChild, 'el-tooltip') && cellChild.childNodes.length)) {\r\n    //   return;\r\n    // }\r\n    // // use range width instead of scrollWidth to determine whether the text is overflowing\r\n    // // to address a potential FireFox bug: https://bugzilla.mozilla.org/show_bug.cgi?id=1074543#c3\r\n    // const range = document.createRange();\r\n    // range.setStart(cellChild, 0);\r\n    // range.setEnd(cellChild, cellChild.childNodes.length);\r\n    // const rangeWidth = range.getBoundingClientRect().width;\r\n    // const padding = (parseInt(getStyle(cellChild, 'paddingLeft'), 10) || 0) +\r\n    //   (parseInt(getStyle(cellChild, 'paddingRight'), 10) || 0);\r\n    // if ((rangeWidth + padding > cellChild.offsetWidth || cellChild.scrollWidth > cellChild.offsetWidth) && this.$refs.tooltip) {\r\n    //   const tooltip = this.$refs.tooltip;\r\n    //   // TODO 会引起整个 Table 的重新渲染，需要优化\r\n    //   this.tooltipContent = cell.innerText || cell.textContent;\r\n    //   tooltip.referenceElm = cell;\r\n    //   tooltip.$refs.popper && (tooltip.$refs.popper.style.display = 'none');\r\n    //   tooltip.doDestroy();\r\n    //   tooltip.setExpectedState(true);\r\n    //   this.activateTooltip(tooltip);\r\n    // }\r\n    computedWidth() {\r\n      const dom = document.querySelector('#box');\r\n      const range = document.createRange();\r\n      range.setStart(dom, 0);\r\n      range.setEnd(dom, dom.childNodes.length);\r\n      const rangeWidth = range.getBoundingClientRect().width;\r\n      // const domWidth = dom.getBoundingClientRect().width\r\n      // if (domWidth < rangeWidth) {\r\n\r\n      // }\r\n      // console.log(rangeWidth, rangeWidth2)\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style>\r\n.textBox {\r\n  width: 300px;\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./directiveTest.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./directiveTest.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./directiveTest.vue?vue&type=template&id=3c6f028b&\"\nimport script from \"./directiveTest.vue?vue&type=script&lang=js&\"\nexport * from \"./directiveTest.vue?vue&type=script&lang=js&\"\nimport style0 from \"./directiveTest.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./textOverflow.vue?vue&type=style&index=0&id=6f82dea5&scoped=true&lang=less&\""],"sourceRoot":""}